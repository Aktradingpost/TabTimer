<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TabTimer - Management</title>
  <style>
    :root {
      --primary: #f97316;
      --primary-hover: #ea580c;
      --primary-light: #fed7aa;
      --secondary: #3b82f6;
      --secondary-hover: #2563eb;
      --secondary-light: #bfdbfe;
      --success: #22c55e;
      --warning: #f59e0b;
      --danger: #ef4444;
      --bg: #f8fafc;
      --bg-card: #ffffff;
      --bg-input: #ffffff;
      --text: #1e293b;
      --text-muted: #64748b;
      --border: #e2e8f0;
      --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    }
    
    body.dark {
      --bg: #0f172a;
      --bg-card: #1e293b;
      --bg-input: #334155;
      --text: #f1f5f9;
      --text-muted: #94a3b8;
      --border: #334155;
      --primary-light: #7c2d12;
      --secondary-light: #1e3a5f;
      --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
    }
    
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
    }
    
    .header {
      background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
      padding: 20px 32px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      position: sticky;
      top: 0;
      z-index: 100;
    }
    
    .logo { display: flex; align-items: center; gap: 14px; color: white; }
    .logo-icon { font-size: 36px; }
    .logo h1 { font-size: 24px; font-weight: 700; }
    .logo span { font-size: 12px; opacity: 0.9; }
    .premium-badge {
      background: gold;
      color: #1e293b;
      padding: 2px 8px;
      border-radius: 4px;
      font-size: 10px;
      font-weight: 700;
      margin-left: 8px;
    }
    
    .header-actions { display: flex; gap: 10px; align-items: center; }
    
    .header-btn {
      background: rgba(255,255,255,0.2);
      border: none;
      border-radius: 8px;
      padding: 8px 12px;
      cursor: pointer;
      color: white;
      font-size: 14px;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .header-btn:hover { background: rgba(255,255,255,0.3); }
    
    .main-container { display: flex; min-height: calc(100vh - 80px); }
    
    .sidebar {
      width: 240px;
      background: var(--bg-card);
      border-right: 1px solid var(--border);
      padding: 16px 0;
      flex-shrink: 0;
    }
    
    .sidebar-section { margin-bottom: 24px; }
    
    .sidebar-title {
      font-size: 11px;
      font-weight: 600;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 1px;
      padding: 0 16px;
      margin-bottom: 8px;
    }
    
    .sidebar-item {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px 16px;
      cursor: pointer;
      color: var(--text);
      text-decoration: none;
      font-size: 14px;
    }
    .sidebar-item:hover { background: var(--primary-light); }
    .sidebar-item.active { background: var(--primary); color: white; }
    
    .sidebar-item .count {
      margin-left: auto;
      background: var(--border);
      padding: 2px 8px;
      border-radius: 10px;
      font-size: 12px;
    }
    .sidebar-item.active .count { background: rgba(255,255,255,0.2); }
    
    .folder-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      flex-shrink: 0;
    }
    
    .content { flex: 1; padding: 24px; overflow-y: auto; }
    
    .card {
      background: var(--bg-card);
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: var(--shadow);
    }
    
    .card-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 16px;
    }
    
    .card-title {
      font-size: 18px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 16px;
      margin-bottom: 24px;
    }
    
    .stat-card {
      background: var(--bg-card);
      border-radius: 12px;
      padding: 16px;
      text-align: center;
      box-shadow: var(--shadow);
    }
    .stat-icon { font-size: 24px; margin-bottom: 8px; }
    .stat-value { font-size: 28px; font-weight: 700; color: var(--primary); }
    .stat-label { font-size: 12px; color: var(--text-muted); }
    
    .toolbar {
      display: flex;
      gap: 12px;
      margin-bottom: 16px;
      flex-wrap: wrap;
      align-items: center;
    }
    
    .search-box { flex: 1; min-width: 200px; position: relative; }
    .search-box input {
      width: 100%;
      padding: 10px 36px 10px 40px;
      border: 1px solid var(--border);
      border-radius: 8px;
      background: var(--bg-input);
      color: var(--text);
      font-size: 14px;
    }
    .search-box::before {
      content: 'üîç';
      position: absolute;
      left: 12px;
      top: 50%;
      transform: translateY(-50%);
    }
    .search-clear {
      position: absolute;
      right: 8px;
      top: 50%;
      transform: translateY(-50%);
      background: var(--text-muted);
      color: var(--bg-card);
      border: none;
      border-radius: 50%;
      width: 20px;
      height: 20px;
      font-size: 14px;
      line-height: 1;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0.7;
      transition: opacity 0.2s;
    }
    .search-clear:hover {
      opacity: 1;
    }
    
    .filter-select {
      padding: 10px 16px;
      border: 1px solid var(--border);
      border-radius: 8px;
      background: var(--bg-input);
      color: var(--text);
      font-size: 14px;
      cursor: pointer;
    }
    
    .btn {
      padding: 10px 16px;
      border: none;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }
    .btn-primary { background: var(--primary); color: white; }
    .btn-primary:hover { background: var(--primary-hover); }
    .btn-secondary { background: var(--secondary); color: white; }
    .btn-outline { background: transparent; border: 1px solid var(--border); color: var(--text); }
    .btn-outline:hover { background: var(--border); }
    .btn-danger { background: var(--danger); color: white; }
    .btn-sm { padding: 6px 10px; font-size: 12px; }
    .btn-icon { padding: 8px; min-width: auto; }
    
    .schedule-list { 
      display: flex; 
      flex-direction: column; 
      gap: 12px; 
      padding-bottom: 80px; /* Space for bulk actions bar */
    }
    
    .schedule-item {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 14px;
      display: flex;
      align-items: flex-start;
      gap: 12px;
      position: relative;
    }
    .schedule-item:hover { box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); }
    .schedule-item.selected { border-color: var(--primary); background: var(--primary-light); }
    .schedule-item.opened { opacity: 0.6; }
    
    .schedule-color-bar {
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 4px;
      border-radius: 10px 0 0 10px;
    }
    
    .schedule-checkbox { margin-top: 4px; }
    .schedule-info { flex: 1; min-width: 0; padding-left: 8px; }
    
    .schedule-header {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 4px;
      flex-wrap: wrap;
    }
    
    .schedule-name {
      font-weight: 600;
      font-size: 15px;
      cursor: pointer;
      padding: 2px 6px;
      margin: -2px -6px;
      border-radius: 4px;
    }
    .schedule-name:hover { background: var(--primary-light); }
    
    .badge {
      padding: 2px 8px;
      border-radius: 4px;
      font-size: 11px;
      font-weight: 500;
    }
    .badge-category { background: var(--secondary-light); color: var(--secondary); }
    .badge-recurring { background: #dcfce7; color: #16a34a; }
    .badge-tag { background: var(--border); color: var(--text-muted); }
    
    .schedule-url {
      font-size: 12px;
      color: var(--text-muted);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      margin-bottom: 6px;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    
    .resolved-url-indicator {
      font-size: 11px;
      cursor: help;
      flex-shrink: 0;
      opacity: 0.7;
    }
    .resolved-url-indicator:hover {
      opacity: 1;
    }
    
    .schedule-meta {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      font-size: 12px;
      color: var(--text-muted);
    }
    
    .schedule-actions { display: flex; gap: 6px; flex-shrink: 0; }
    
    .bulk-actions {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: var(--bg-card);
      padding: 12px 20px;
      border-radius: 12px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
      display: none;
      align-items: center;
      gap: 16px;
      z-index: 1000;
    }
    .bulk-actions.visible { display: flex; }
    
    .form-group { margin-bottom: 16px; }
    .form-group label {
      display: block;
      font-size: 13px;
      font-weight: 500;
      margin-bottom: 6px;
    }
    .form-group input,
    .form-group select,
    .form-group textarea {
      width: 100%;
      padding: 10px 14px;
      border: 1px solid var(--border);
      border-radius: 8px;
      background: var(--bg-input);
      color: var(--text);
      font-size: 14px;
    }
    .form-group textarea { min-height: 80px; resize: vertical; }
    .form-row { display: flex; gap: 12px; }
    .form-row .form-group { flex: 1; }
    
    .btn-group { display: flex; flex-wrap: wrap; gap: 8px; }
    .btn-group .btn-option {
      padding: 8px 14px;
      border: 2px solid var(--border);
      background: var(--bg-input);
      color: var(--text);
      border-radius: 8px;
      cursor: pointer;
      font-size: 13px;
    }
    .btn-group .btn-option:hover { border-color: var(--primary); }
    .btn-group .btn-option.active {
      border-color: var(--primary);
      background: var(--primary);
      color: white;
    }
    
    .color-options { display: flex; gap: 8px; flex-wrap: wrap; }
    .color-option {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      cursor: pointer;
      border: 3px solid transparent;
    }
    .color-option:hover { transform: scale(1.1); }
    .color-option.selected { border-color: var(--text); }
    
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.5);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 2000;
    }
    .modal-overlay.visible { display: flex; }
    
    .modal {
      background: var(--bg-card);
      border-radius: 16px;
      max-width: 600px;
      width: 90%;
      max-height: 90vh;
      overflow-y: auto;
    }
    
    .modal-header {
      padding: 20px;
      border-bottom: 1px solid var(--border);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .modal-header h3 { font-size: 18px; }
    .modal-close {
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: var(--text-muted);
    }
    .modal-body { padding: 20px; }
    .modal-footer {
      padding: 16px 20px;
      border-top: 1px solid var(--border);
      display: flex;
      justify-content: flex-end;
      gap: 10px;
    }
    
    .toast {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: var(--bg-card);
      padding: 14px 20px;
      border-radius: 10px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      display: none;
      align-items: center;
      gap: 10px;
      z-index: 3000;
    }
    .toast.visible { display: flex; }
    
    .shortcuts-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 12px;
    }
    .shortcut-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 10px;
      background: var(--bg);
      border-radius: 8px;
    }
    .shortcut-keys { display: flex; gap: 4px; }
    .key {
      background: var(--bg-card);
      border: 1px solid var(--border);
      padding: 4px 10px;
      border-radius: 6px;
      font-size: 12px;
      font-family: monospace;
      font-weight: 600;
    }
    
    .empty-state {
      text-align: center;
      padding: 60px 20px;
      color: var(--text-muted);
    }
    .empty-state-icon { font-size: 64px; margin-bottom: 16px; }
    .empty-state h3 { font-size: 20px; margin-bottom: 8px; color: var(--text); }
    
    .card-tabs {
      display: flex;
      gap: 4px;
      margin-bottom: 16px;
      border-bottom: 1px solid var(--border);
      padding-bottom: 8px;
    }
    .card-tab {
      padding: 8px 16px;
      background: transparent;
      border: none;
      color: var(--text-muted);
      cursor: pointer;
      font-size: 14px;
      border-radius: 6px 6px 0 0;
    }
    .card-tab:hover { color: var(--text); }
    .card-tab.active { color: var(--primary); background: var(--primary-light); }
    .card-tab-content { display: none; }
    .card-tab-content.active { display: block; }
    
    .ie-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 16px;
    }
    .ie-card {
      border: 2px dashed var(--border);
      border-radius: 12px;
      padding: 20px;
      text-align: center;
    }
    .ie-card h4 { margin-bottom: 8px; }
    .ie-card p { font-size: 13px; color: var(--text-muted); margin-bottom: 12px; }
    
    .collapsible {
      border: 1px solid var(--border);
      border-radius: 10px;
      margin-bottom: 12px;
    }
    .collapsible-header {
      padding: 14px 16px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: var(--bg);
      border-radius: 10px;
    }
    .collapsible-header:hover { background: var(--primary-light); }
    .collapsible-content {
      padding: 16px;
      display: none;
      border-top: 1px solid var(--border);
    }
    .collapsible.open .collapsible-content { display: block; }
    .collapsible.open .collapsible-header { border-radius: 10px 10px 0 0; }
    .collapsible-icon { transition: transform 0.2s; }
    .collapsible.open .collapsible-icon { transform: rotate(180deg); }
    
    /* Drag and Drop Styles */
    .schedule-item.draggable {
      cursor: grab;
    }
    .schedule-item.draggable:active {
      cursor: grabbing;
    }
    .schedule-item.dragging {
      opacity: 0.5;
      transform: scale(1.02);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
    }
    .schedule-item.drag-over {
      border-top: 3px solid var(--primary);
      margin-top: -3px;
    }
    .drag-handle {
      cursor: grab;
      padding: 8px;
      color: var(--text-muted);
      font-size: 16px;
      user-select: none;
    }
    .drag-handle:hover {
      color: var(--primary);
    }
    
    /* Saved Search Filter Pills */
    .filter-pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 10px;
      background: var(--primary-light);
      border: 1px solid var(--primary);
      border-radius: 20px;
      font-size: 12px;
      cursor: pointer;
      transition: all 0.2s;
    }
    .filter-pill:hover {
      background: var(--primary);
      color: white;
    }
    .filter-pill .delete-filter {
      font-size: 14px;
      opacity: 0.7;
    }
    .filter-pill .delete-filter:hover {
      opacity: 1;
    }
    
    /* CSV Preview Table */
    #csvPreviewTable th, #csvPreviewTable td {
      padding: 6px 10px;
      text-align: left;
      border-bottom: 1px solid var(--border);
    }
    #csvPreviewTable th {
      font-weight: 600;
      background: var(--bg-card);
      position: sticky;
      top: 0;
    }
    #csvPreviewTable tr:hover td {
      background: var(--primary-light);
    }
    #csvDropZone.dragover {
      border-color: var(--primary);
      background: var(--primary-light);
    }
    
    @media (max-width: 768px) {
      .main-container { flex-direction: column; }
      .sidebar { width: 100%; border-right: none; border-bottom: 1px solid var(--border); }
    }
  </style>
</head>
<body>
  <header class="header">
    <div class="logo">
      <span class="logo-icon">&#128336;</span>
      <div>
        <h1>TabTimer <span class="premium-badge" id="headerPremiumBadge" style="display: none;">PREMIUM</span></h1>
        <span>Smart Website Scheduler v2.0</span>
      </div>
    </div>
    <div class="header-actions">
      <button class="header-btn" id="pauseAllBtn" title="Pause/Resume All Schedules" style="background: #22c55e;">‚ñ∂Ô∏è Active</button>
      <button class="header-btn" id="keyboardShortcutsBtn" title="Keyboard Shortcuts">&#9000; Shortcuts</button>
      <button class="header-btn" id="themeToggle" title="Toggle Theme">&#127769; Theme</button>
      <button class="header-btn" id="licenseBtn">‚ú® Try Premium</button>
    </div>
  </header>
  
  <div class="main-container">
    <nav class="sidebar">
      <div class="sidebar-section">
        <div class="sidebar-title">Navigation</div>
        <a class="sidebar-item active" data-view="schedules">&#128197; All Schedules <span class="count" id="totalCount">0</span></a>
        <a class="sidebar-item" data-view="add">&#10133; Add New</a>
        <a class="sidebar-item premium-feature" data-view="bulk">&#128229; Bulk Import <span class="premium-badge" style="font-size: 10px; padding: 2px 6px; margin-left: 4px;">PRO</span></a>
        <a class="sidebar-item premium-locked" data-action="showPremiumPrompt" style="opacity: 0.6;">&#128229; Bulk Import <span style="font-size: 10px; padding: 2px 6px; margin-left: 4px; background: #94a3b8; border-radius: 4px;">üîí</span></a>
      </div>
      
      <div class="sidebar-section">
        <div class="sidebar-title">Quick Filters</div>
        <a class="sidebar-item" data-filter="active">&#9200; Active <span class="count" id="activeCount">0</span></a>
        <a class="sidebar-item" data-filter="notactive">&#128683; Not Active <span class="count" id="notActiveCount">0</span></a>
        <a class="sidebar-item" data-filter="today">&#128198; Today <span class="count" id="todayCount">0</span></a>
        <a class="sidebar-item" data-filter="cat-daily" id="filterDaily" style="display:none;">&#128197; Daily <span class="count" id="dailyCount">0</span></a>
        <a class="sidebar-item" data-filter="cat-weekly" id="filterWeekly" style="display:none;">&#128198; Weekly <span class="count" id="weeklyCount">0</span></a>
        <a class="sidebar-item" data-filter="cat-monthly" id="filterMonthly" style="display:none;">&#128467; Monthly <span class="count" id="monthlyCount">0</span></a>
        <a class="sidebar-item" data-filter="cat-once" id="filterOnce" style="display:none;">&#127919; Once <span class="count" id="onceCount">0</span></a>
        <a class="sidebar-item" data-filter="cat-other" id="filterOther" style="display:none;">&#128204; Other <span class="count" id="otherCount">0</span></a>
        <div id="customCategoryFilters"></div>
      </div>
      
      <div class="sidebar-section">
        <div class="sidebar-title">Tools</div>
        <a class="sidebar-item premium-feature" data-view="categories">&#127991; Categories <span class="premium-badge" style="font-size: 10px; padding: 2px 6px; margin-left: 4px;">PRO</span></a>
        <a class="sidebar-item premium-locked" data-action="showPremiumPrompt" style="opacity: 0.6;">&#127991; Categories <span style="font-size: 10px; padding: 2px 6px; margin-left: 4px; background: #94a3b8; border-radius: 4px;">üîí</span></a>
        <a class="sidebar-item" data-view="backup">&#128190; Backup/Sync</a>
        <a class="sidebar-item" data-view="settings">&#9881; Settings</a>
      </div>
    </nav>
    
    <main class="content">
      <div class="stats-grid" id="statsGrid">
        <div class="stat-card">
          <div class="stat-icon">&#128202;</div>
          <div class="stat-value" id="statTotal">0</div>
          <div class="stat-label">Total Schedules</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon">&#9200;</div>
          <div class="stat-value" id="statActive">0</div>
          <div class="stat-label">Active</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon">&#128257;</div>
          <div class="stat-value" id="statRecurring">0</div>
          <div class="stat-label">Recurring</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon">&#128200;</div>
          <div class="stat-value" id="statTotalOpens">0</div>
          <div class="stat-label">Total Opens</div>
        </div>
      </div>
      
      <div id="view-schedules" class="view-content">
        <div class="card">
          <div class="toolbar">
            <div class="search-box" style="position: relative;">
              <input type="text" id="searchInput" placeholder="Search schedules...">
              <button type="button" id="searchClearBtn" class="search-clear" style="display: none;">&times;</button>
            </div>
            <select class="filter-select" id="categoryFilter">
              <option value="">All Categories</option>
            </select>
            <select class="filter-select" id="sortSelect">
              <option value="custom">Custom Order</option>
              <option value="time-asc">Time (Soon - Late)</option>
              <option value="time-desc">Time (Late - Soon)</option>
              <option value="name-asc">Name (A - Z)</option>
              <option value="name-desc">Name (Z - A)</option>
              <option value="url-asc">URL (A - Z)</option>
              <option value="url-desc">URL (Z - A)</option>
            </select>
            <button class="btn btn-outline btn-sm" id="selectAllBtn">Select All</button>
            <button class="btn btn-outline btn-sm" id="advancedSearchBtn" title="Advanced Search">üîç</button>
          </div>
          
          <!-- Advanced Search Panel -->
          <div id="advancedSearchPanel" style="display: none; padding: 16px; background: var(--bg); border-radius: 8px; margin-bottom: 16px;">
            <div class="form-row" style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 12px;">
              <div class="form-group" style="margin: 0;">
                <label style="font-size: 12px;">Search By</label>
                <select id="searchDateType">
                  <option value="scheduled">Scheduled Time</option>
                  <option value="expiration">Expiration Date (in name)</option>
                  <option value="both">Either Date</option>
                </select>
              </div>
              <div class="form-group" style="margin: 0;">
                <label style="font-size: 12px;">Date From</label>
                <input type="date" id="searchDateFrom">
              </div>
              <div class="form-group" style="margin: 0;">
                <label style="font-size: 12px;">Date To</label>
                <input type="date" id="searchDateTo">
              </div>
              <div class="form-group" style="margin: 0;">
                <label style="font-size: 12px;">Status</label>
                <select id="searchStatus">
                  <option value="">All</option>
                  <option value="active">Active Only</option>
                  <option value="opened">Opened/Unlocked</option>
                  <option value="recurring">Recurring Only</option>
                  <option value="one-time">One-time Only</option>
                </select>
              </div>
            </div>
            <div style="display: flex; gap: 8px; margin-top: 12px;">
              <button class="btn btn-primary btn-sm" id="applyAdvancedSearch">Apply Filters</button>
              <button class="btn btn-outline btn-sm" id="clearAdvancedSearch">Clear</button>
              <button class="btn btn-outline btn-sm premium-feature" id="saveSearchFilter">üíæ Save Filter <span class="premium-badge" style="font-size: 9px; padding: 1px 4px;">PRO</span></button>
            </div>
            <div id="savedFiltersContainer" style="margin-top: 12px; display: none;">
              <label style="font-size: 12px;">Saved Filters:</label>
              <div id="savedFiltersList" style="display: flex; gap: 8px; flex-wrap: wrap; margin-top: 6px;"></div>
            </div>
          </div>
          
          <div class="schedule-list" id="scheduleList"></div>
          <div id="dragDropHint" style="display: none; text-align: center; padding: 12px; color: var(--text-muted); font-size: 13px;">
            üí° Tip: Drag and drop schedules to reorder (when sorted by "Custom Order")
          </div>
        </div>
      </div>
      
      <div id="view-add" class="view-content" style="display: none;">
        <div class="card">
          <h3 class="card-title">Add New Schedule</h3>
          <br>
          <div class="form-group">
            <label>URL *</label>
            <input type="url" id="newUrl" placeholder="https://example.com">
          </div>
          <div class="form-group">
            <label>Name</label>
            <input type="text" id="newName" placeholder="e.g., 2026-01-31 My Event">
            <small style="color: var(--text-muted);">Names starting with YYYY-MM-DD will auto-delete after that date</small>
          </div>
          <div class="form-group">
            <label>Category</label>
            <select id="newCategory"></select>
          </div>
          <input type="hidden" id="newFolder" value="default">
          <div class="form-group premium-feature">
            <label>Color (optional) <span class="premium-badge" style="font-size: 10px; padding: 2px 6px; margin-left: 4px;">PRO</span></label>
            <div class="color-options" id="newColorOptions">
              <div class="color-option" data-color="" style="background: linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%), linear-gradient(45deg, #ccc 25%, #fff 25%, #fff 75%, #ccc 75%); background-size: 8px 8px;" title="No color"></div>
              <div class="color-option" data-color="#ef4444" style="background: #ef4444;"></div>
              <div class="color-option" data-color="#f97316" style="background: #f97316;"></div>
              <div class="color-option" data-color="#eab308" style="background: #eab308;"></div>
              <div class="color-option" data-color="#22c55e" style="background: #22c55e;"></div>
              <div class="color-option" data-color="#06b6d4" style="background: #06b6d4;"></div>
              <div class="color-option" data-color="#3b82f6" style="background: #3b82f6;"></div>
              <div class="color-option" data-color="#8b5cf6" style="background: #8b5cf6;"></div>
              <div class="color-option" data-color="#ec4899" style="background: #ec4899;"></div>
            </div>
            <input type="hidden" id="newColor" value="">
          </div>
          <div class="form-group">
            <label>Open at *</label>
            <input type="datetime-local" id="newDatetime" step="1">
          </div>
          <div class="form-group">
            <label>Repeat Schedule</label>
            <select id="newRepeatSelect" style="margin-bottom: 8px;">
              <option value="none">No Repeat (One-time)</option>
              <option value="daily" selected>Daily</option>
              <option value="weekdays">Weekdays (Mon-Fri)</option>
              <option value="weekends">Weekends (Sat-Sun)</option>
              <option value="weekly">Weekly</option>
              <option value="biweekly">Every 2 Weeks</option>
              <option value="every3weeks">Every 3 Weeks</option>
              <option value="monthly">Monthly</option>
              <option value="bimonthly">Every 2 Months</option>
              <option value="quarterly">Quarterly (Every 3 Months)</option>
              <option value="every6months">Every 6 Months</option>
              <option value="yearly">Yearly</option>
              <option value="leapyear">Leap Year (Every 4 Years)</option>
              <option value="minutes">Every X Minutes</option>
              <option value="hourly">Every X Hours</option>
              <option value="custom-days">Custom Days Interval</option>
              <option value="specific-dates">Specific Dates</option>
            </select>
            <input type="hidden" id="newRepeat" value="daily">
          </div>
          
          <!-- Minute interval options -->
          <div class="form-group" id="minuteIntervalGroup" style="display: none;">
            <label>Repeat every <input type="number" id="newMinuteInterval" min="1" max="59" value="10" style="width: 60px; display: inline;"> minutes</label>
            <small style="color: var(--text-muted); display: block; margin-top: 4px;">Great for opening a URL multiple times in quick succession!</small>
          </div>
          
          <!-- Hourly interval options -->
          <div class="form-group" id="hourlyIntervalGroup" style="display: none;">
            <label>Repeat every <input type="number" id="newHourlyInterval" min="1" max="23" value="6" style="width: 60px; display: inline;"> hours</label>
          </div>
          
          <!-- Custom days interval options -->
          <div class="form-group" id="customDaysGroup" style="display: none;">
            <label>Repeat every <input type="number" id="newCustomDays" min="2" max="365" value="3" style="width: 60px; display: inline;"> days</label>
          </div>
          
          <!-- Specific dates options -->
          <div class="form-group" id="specificDatesGroup" style="display: none;">
            <label>Select specific dates (comma separated, e.g., 2026-01-20, 2026-01-25)</label>
            <input type="text" id="newSpecificDates" placeholder="2026-01-20, 2026-01-25, 2026-02-01">
            <small style="color: var(--text-muted);">Enter dates in YYYY-MM-DD format</small>
          </div>
          
          <div class="form-group">
            <label>Auto re-lock after unlocking</label>
            <div class="btn-group" id="newLockMinutesGroup">
              <button type="button" class="btn-option" data-value="0">Never</button>
              <button type="button" class="btn-option" data-value="1">1 min</button>
              <button type="button" class="btn-option" data-value="2">2 min</button>
              <button type="button" class="btn-option active" data-value="5">5 min</button>
              <button type="button" class="btn-option" data-value="10">10 min</button>
              <button type="button" class="btn-option" data-value="15">15 min</button>
              <button type="button" class="btn-option" data-value="30">30 min</button>
            </div>
            <input type="hidden" id="newLockMinutes" value="5">
          </div>
          
          <!-- Auto-close tab option -->
          <div class="form-group">
            <label><input type="checkbox" id="newAutoClose"> Auto-close tab after opening</label>
          </div>
          <div class="form-group" id="autoCloseMinutesGroup" style="display: none;">
            <label>Close tab after <input type="number" id="newAutoCloseMinutes" min="1" max="60" value="5" style="width: 60px; display: inline;"> minutes</label>
          </div>
          
          <!-- Sound notification option -->
          <div class="form-group">
            <label><input type="checkbox" id="newPlaySound"> üîä Play sound when tab opens</label>
          </div>
          <br>
          <button class="btn btn-primary" id="createScheduleBtn">Create Schedule</button>
        </div>
      </div>
      
      <div id="view-bulk" class="view-content" style="display: none;">
        <div class="card">
          <h3 class="card-title">Bulk Import</h3>
          <br>
          <div class="card-tabs">
            <button class="card-tab active" data-tab="text">From Text</button>
            <button class="card-tab" data-tab="csv">From CSV/Excel</button>
            <button class="card-tab" data-tab="bookmarks">From Bookmarks</button>
          </div>
          <div class="card-tab-content active" id="tab-text">
            <div class="form-group">
              <label>URLs (one per line)</label>
              <textarea id="bulkUrls" rows="8" placeholder="https://example1.com&#10;https://example2.com"></textarea>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label>Category for all</label>
                <select id="bulkCategory"></select>
              </div>
              <div class="form-group">
                <label>Start time</label>
                <input type="datetime-local" id="bulkStartTime" step="1">
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label><input type="checkbox" id="bulkStagger" checked> Stagger timing</label>
              </div>
              <div class="form-group">
                <label>Stagger interval</label>
                <select id="bulkStaggerInterval">
                  <option value="15">15 seconds</option>
                  <option value="30">30 seconds</option>
                  <option value="45">45 seconds</option>
                  <option value="60" selected>1 minute</option>
                  <option value="120">2 minutes</option>
                  <option value="300">5 minutes</option>
                </select>
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label><input type="checkbox" id="bulkRecurring" checked> Make all recurring</label>
              </div>
              <div class="form-group">
                <label>Repeat type</label>
                <select id="bulkRepeatType">
                  <option value="daily">Daily</option>
                  <option value="weekdays">Weekdays</option>
                  <option value="weekends">Weekends</option>
                  <option value="weekly">Weekly</option>
                  <option value="biweekly">Every 2 Weeks</option>
                  <option value="every3weeks">Every 3 Weeks</option>
                  <option value="monthly">Monthly</option>
                  <option value="bimonthly">Every 2 Months</option>
                  <option value="quarterly">Quarterly</option>
                  <option value="every6months">Every 6 Months</option>
                  <option value="yearly">Yearly</option>
                  <option value="leapyear">Leap Year</option>
                </select>
              </div>
            </div>
            <div class="form-group">
              <label><input type="checkbox" id="bulkPlaySound"> üîä Play sound when tabs open</label>
            </div>
            <button class="btn btn-primary" id="bulkImportBtn">Import URLs</button>
          </div>
          <div class="card-tab-content" id="tab-csv">
            <div class="form-group">
              <label>Upload CSV or Excel File</label>
              <div style="border: 2px dashed var(--border); border-radius: 10px; padding: 30px; text-align: center; cursor: pointer;" id="csvDropZone">
                <div style="font-size: 40px; margin-bottom: 10px;">üìÑ</div>
                <p style="margin-bottom: 10px;">Drag & drop a CSV or Excel file here</p>
                <p style="color: var(--text-muted); font-size: 13px;">or click to browse</p>
                <input type="file" id="csvFileInput" accept=".csv,.xlsx,.xls" style="display: none;">
              </div>
              <div id="csvFileName" style="margin-top: 10px; display: none; padding: 10px; background: var(--bg); border-radius: 8px;">
                <span id="csvFileNameText"></span>
                <button class="btn btn-sm btn-outline" id="csvClearFile" style="margin-left: 10px;">‚úï Clear</button>
              </div>
            </div>
            <div class="form-group">
              <label>File Format Instructions</label>
              <div style="background: var(--bg); padding: 14px; border-radius: 8px; font-size: 13px;">
                <p style="margin-bottom: 8px;"><strong>Simple format:</strong> Just paste URLs in Column A (one per row) - no header needed!</p>
                <p style="margin-bottom: 8px;"><strong>Or use headers:</strong> <code>url</code> (required), plus optional columns:</p>
                <ul style="margin: 0; padding-left: 20px; color: var(--text-muted);">
                  <li><code>name</code> - Schedule name</li>
                  <li><code>category</code> - Category name (Daily, Weekly, etc.)</li>
                  <li><code>time</code> - Time in HH:MM or HH:MM:SS format</li>
                  <li><code>date</code> - Date in YYYY-MM-DD format</li>
                  <li><code>recurring</code> - true/false</li>
                  <li><code>repeat</code> - daily, weekly, monthly, etc.</li>
                  <li><code>notes</code> - Notes for the schedule</li>
                </ul>
                <p style="margin-top: 10px;"><a href="#" id="downloadCsvTemplate" style="color: var(--primary);">üì• Download template CSV</a></p>
              </div>
            </div>
            <div id="csvPreview" style="display: none;">
              <div class="form-group">
                <label>Preview (<span id="csvRowCount">0</span> rows found)</label>
                <div style="background: var(--bg); border-radius: 10px; padding: 14px; max-height: 200px; overflow-y: auto;">
                  <table style="width: 100%; font-size: 12px; border-collapse: collapse;" id="csvPreviewTable">
                    <thead id="csvPreviewHead"></thead>
                    <tbody id="csvPreviewBody"></tbody>
                  </table>
                </div>
              </div>
              
              <!-- Apply to All URLs Section -->
              <div class="form-group" style="background: var(--primary-light); padding: 16px; border-radius: 10px; margin-bottom: 16px;">
                <label style="font-weight: 600; margin-bottom: 12px; display: block;">üìã Apply to All Imported URLs</label>
                <div class="form-row">
                  <div class="form-group" style="margin-bottom: 0;">
                    <label>Expiration Date (added to name)</label>
                    <input type="date" id="csvExpirationDate" style="width: 100%;">
                    <small style="color: var(--text-muted);">Format: 2025-03-15 - Added as prefix to schedule name</small>
                  </div>
                  <div class="form-group" style="margin-bottom: 0;">
                    <label>Name / Description</label>
                    <input type="text" id="csvNamePrefix" placeholder="e.g., My Schedule Name" style="width: 100%;">
                    <small style="color: var(--text-muted);">Applied to all URLs without a name in the file</small>
                  </div>
                </div>
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label>Default Category (if not in file)</label>
                <select id="csvCategory"></select>
              </div>
              <div class="form-group">
                <label>Default Start Time (if not in file)</label>
                <input type="datetime-local" id="csvStartTime" step="1">
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label><input type="checkbox" id="csvStagger" checked> Stagger timing (for rows without time)</label>
              </div>
              <div class="form-group">
                <label>Stagger interval</label>
                <select id="csvStaggerInterval">
                  <option value="15">15 seconds</option>
                  <option value="30">30 seconds</option>
                  <option value="45">45 seconds</option>
                  <option value="60" selected>1 minute</option>
                  <option value="120">2 minutes</option>
                  <option value="300">5 minutes</option>
                </select>
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label><input type="checkbox" id="csvRecurring" checked> Make recurring (if not specified)</label>
              </div>
              <div class="form-group">
                <label>Default Repeat type</label>
                <select id="csvRepeatType">
                  <option value="daily">Daily</option>
                  <option value="weekdays">Weekdays</option>
                  <option value="weekends">Weekends</option>
                  <option value="weekly">Weekly</option>
                  <option value="monthly">Monthly</option>
                  <option value="yearly">Yearly</option>
                </select>
              </div>
            </div>
            <div class="form-group">
              <label><input type="checkbox" id="csvPlaySound"> üîä Play sound when tabs open</label>
            </div>
            <button class="btn btn-primary" id="csvImportBtn" disabled>Import from File</button>
          </div>
          <div class="card-tab-content" id="tab-bookmarks">
            <div class="form-group">
              <label>Select Bookmark Folder</label>
              <select id="bookmarkFolder"><option value="">-- Select a folder --</option></select>
            </div>
            <div id="bookmarkPreview" style="display: none;">
              <div style="background: var(--bg); border-radius: 10px; padding: 14px; max-height: 200px; overflow-y: auto; margin-bottom: 16px;">
                <h4 style="margin-bottom: 10px; font-size: 14px;">Bookmarks in folder: <span id="bookmarkCount">0</span></h4>
                <div id="bookmarkList" style="font-size: 13px; color: var(--text-muted);"></div>
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label>Category for all</label>
                <select id="bmCategory"></select>
              </div>
              <div class="form-group">
                <label>Start time</label>
                <input type="datetime-local" id="bmStartTime" step="1">
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label><input type="checkbox" id="bmStagger" checked> Stagger timing</label>
              </div>
              <div class="form-group">
                <label>Stagger interval</label>
                <select id="bmStaggerInterval">
                  <option value="15">15 seconds</option>
                  <option value="30">30 seconds</option>
                  <option value="45">45 seconds</option>
                  <option value="60" selected>1 minute</option>
                  <option value="120">2 minutes</option>
                  <option value="300">5 minutes</option>
                </select>
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label><input type="checkbox" id="bmRecurring" checked> Make all recurring</label>
              </div>
              <div class="form-group">
                <label>Repeat type</label>
                <select id="bmRepeatType">
                  <option value="daily">Daily</option>
                  <option value="weekdays">Weekdays</option>
                  <option value="weekends">Weekends</option>
                  <option value="weekly">Weekly</option>
                  <option value="biweekly">Every 2 Weeks</option>
                  <option value="every3weeks">Every 3 Weeks</option>
                  <option value="monthly">Monthly</option>
                  <option value="bimonthly">Every 2 Months</option>
                  <option value="quarterly">Quarterly</option>
                  <option value="every6months">Every 6 Months</option>
                  <option value="yearly">Yearly</option>
                  <option value="leapyear">Leap Year</option>
                </select>
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label>Auto re-lock after unlocking</label>
                <select id="bmLockMinutes">
                  <option value="0">Never</option>
                  <option value="1">1 minute</option>
                  <option value="2">2 minutes</option>
                  <option value="5" selected>5 minutes</option>
                  <option value="10">10 minutes</option>
                  <option value="15">15 minutes</option>
                  <option value="30">30 minutes</option>
                </select>
              </div>
              <div class="form-group">
                <label>Color (optional) <span class="premium-badge" style="font-size: 10px; padding: 2px 6px;">PRO</span></label>
                <input type="color" id="bmColor" value="#3b82f6" style="width: 100%; height: 38px; padding: 2px; border: 1px solid var(--border); border-radius: 8px; cursor: pointer;">
              </div>
            </div>
            <div class="form-group">
              <label><input type="checkbox" id="bmPlaySound"> üîä Play sound when tabs open</label>
            </div>
            <button class="btn btn-primary" id="bmImportBtn" disabled>Import from Folder</button>
          </div>
        </div>
      </div>
      
      <div id="view-categories" class="view-content" style="display: none;">
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">Manage Categories</h3>
            <button class="btn btn-primary btn-sm" id="addCategoryBtn">+ Add Category</button>
          </div>
          <div id="categoriesList"></div>
        </div>
      </div>
      
      <div id="view-backup" class="view-content" style="display: none;">
        <!-- Cloud Sync Card (Premium) -->
        <div class="card premium-feature">
          <div class="card-header">
            <h3 class="card-title">‚òÅÔ∏è Cloud Sync <span class="premium-badge" style="font-size: 10px; padding: 2px 6px; margin-left: 4px;">PRO</span></h3>
          </div>
          <p style="color: var(--text-muted); margin-bottom: 16px;">Sync your schedules across devices. Export to cloud storage or import from another device.</p>
          
          <div id="cloudSyncStatus" style="padding: 12px; background: var(--bg); border-radius: 8px; margin-bottom: 16px;">
            <div style="display: flex; align-items: center; gap: 8px;">
              <span id="cloudSyncIcon">‚òÅÔ∏è</span>
              <span id="cloudSyncStatusText">Not synced yet</span>
            </div>
            <div id="lastSyncTime" style="font-size: 12px; color: var(--text-muted); margin-top: 4px;"></div>
          </div>
          
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 16px;">
            <button class="btn btn-primary" id="cloudExportBtn">
              ‚¨ÜÔ∏è Export for Sync
            </button>
            <button class="btn btn-secondary" id="cloudImportBtn">
              ‚¨áÔ∏è Import from Sync
            </button>
          </div>
          
          <div class="form-group">
            <label style="font-size: 13px; color: var(--text-muted);">
              üí° How to sync: Export your data, save the file to cloud storage (Google Drive, Dropbox, etc.), 
              then import from another device. Your schedules will be merged without duplicates.
            </label>
          </div>
          
          <input type="file" id="cloudImportFile" accept=".json" style="display: none;">
        </div>
        
        <!-- Health Check Card -->
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">üè• Schedule Health Check</h3>
          </div>
          <p style="color: var(--text-muted); margin-bottom: 16px;">Diagnose and fix common issues with your schedules.</p>
          
          <div id="healthCheckStatus" style="padding: 12px; background: var(--bg); border-radius: 8px; margin-bottom: 16px;">
            <span id="healthCheckStatusText">Click to run health check</span>
          </div>
          
          <div id="healthCheckReport" style="display: none; padding: 12px; background: var(--bg); border-radius: 8px; margin-bottom: 16px; font-size: 13px;">
          </div>
          
          <button class="btn btn-outline" id="runHealthCheckBtn">üîç Run Health Check</button>
        </div>
        
        <div class="card">
          <h3 class="card-title">‚è∞ Auto-Backup</h3>
          <p style="color: var(--text-muted); margin-bottom: 16px;">Automatically backup your data on a schedule.</p>
          
          <div class="form-group">
            <label><input type="checkbox" id="autoBackupEnabled"> Enable Auto-Backup</label>
          </div>
          
          <div class="form-group">
            <label>Backup Frequency</label>
            <select id="autoBackupFrequency">
              <option value="daily">Daily</option>
              <option value="weekly">Weekly</option>
              <option value="monthly">Monthly</option>
            </select>
          </div>
          
          <div class="form-group">
            <label>Keep last <input type="number" id="autoBackupKeep" min="1" max="30" value="5" style="width: 60px; display: inline;"> backups</label>
          </div>
          
          <div id="autoBackupStatus" style="padding: 12px; background: var(--bg); border-radius: 8px; margin-bottom: 16px;">
            <span id="autoBackupStatusText">Auto-backup disabled</span>
          </div>
          
          <button class="btn btn-outline btn-sm" id="viewBackupsBtn">üìÅ View Saved Backups</button>
        </div>
        
        <div class="card">
          <h3 class="card-title">üíæ Manual Backup</h3>
          <br>
          <div class="ie-grid">
            <div class="ie-card">
              <h4>Export All</h4>
              <p>Download all data as a JSON backup file.</p>
              <button class="btn btn-primary" id="exportAllBtn">Export All</button>
            </div>
            <div class="ie-card">
              <h4>Import Backup</h4>
              <p>Restore from a backup file.</p>
              <button class="btn btn-secondary" id="importBackupBtn">Import Backup</button>
              <input type="file" id="importBackupFile" accept=".json" style="display: none;">
            </div>
          </div>
        </div>
      </div>
      
      <div id="view-settings" class="view-content" style="display: none;">
        <div class="card">
          <h3 class="card-title">Settings</h3>
          <br>
          <div class="form-group">
            <label><input type="checkbox" id="settingNotifications" checked> Enable notifications</label>
          </div>
          <div class="form-group">
            <label>Notification reminder (minutes before)</label>
            <input type="number" id="settingNotifyMinutes" min="0" value="5">
          </div>
          <div class="form-group">
            <label><input type="checkbox" id="settingAutoDelete" checked> Auto-delete after expiration date in name</label>
          </div>
          <div class="form-group">
            <label><input type="checkbox" id="settingOpenBackground" checked> Open tabs in background</label>
          </div>
          <div class="form-group">
            <label>Grace period for missed schedules</label>
            <select id="settingGracePeriod">
              <option value="2">2 minutes</option>
              <option value="30">30 minutes</option>
              <option value="60" selected>1 hour (default)</option>
              <option value="120">2 hours</option>
              <option value="180">3 hours</option>
              <option value="240">4 hours</option>
              <option value="360">6 hours</option>
              <option value="480">8 hours</option>
            </select>
            <small style="color: var(--text-muted); display: block; margin-top: 4px;">If you open Chrome within this time after a scheduled tab was supposed to open, it will still open (staggered). After this time, recurring schedules move to the next occurrence.</small>
          </div>
          <div class="form-group">
            <label>Stagger interval for missed tabs (seconds)</label>
            <select id="settingMissedTabStagger">
              <option value="5">5 seconds</option>
              <option value="10">10 seconds</option>
              <option value="15" selected>15 seconds (default)</option>
              <option value="30">30 seconds</option>
              <option value="45">45 seconds</option>
              <option value="60">1 minute</option>
            </select>
            <small style="color: var(--text-muted); display: block; margin-top: 4px;">When Chrome opens late and multiple tabs are due, they'll open one at a time with this interval between each.</small>
          </div>
          <div class="form-group">
            <label>Default category</label>
            <select id="settingDefaultCategory"></select>
          </div>
          <div class="form-group">
            <label>Default auto re-lock (minutes)</label>
            <input type="number" id="settingDefaultLockMinutes" min="0" value="5">
            <small style="color: var(--text-muted); display: block; margin-top: 4px;">Set to 0 for "Never" auto re-lock</small>
          </div>
          <div class="form-group">
            <label>Your Timezone</label>
            <select id="settingTimezone">
              <optgroup label="üá∫üá∏ United States">
                <option value="Pacific/Honolulu">Hawaii (HST)</option>
                <option value="America/Anchorage">Alaska (AKST)</option>
                <option value="America/Los_Angeles">Pacific (PST)</option>
                <option value="America/Denver">Mountain (MST)</option>
                <option value="America/Chicago">Central (CST)</option>
                <option value="America/New_York">Eastern (EST)</option>
              </optgroup>
              <optgroup label="üá®üá¶ Canada">
                <option value="America/Vancouver">Vancouver (PST)</option>
                <option value="America/Edmonton">Edmonton (MST)</option>
                <option value="America/Toronto">Toronto (EST)</option>
                <option value="America/Halifax">Halifax (AST)</option>
                <option value="America/St_Johns">Newfoundland (NST)</option>
              </optgroup>
              <optgroup label="üá™üá∫ Europe">
                <option value="Europe/London">London (GMT)</option>
                <option value="Europe/Paris">Paris (CET)</option>
                <option value="Europe/Berlin">Berlin (CET)</option>
                <option value="Europe/Madrid">Madrid (CET)</option>
                <option value="Europe/Rome">Rome (CET)</option>
                <option value="Europe/Amsterdam">Amsterdam (CET)</option>
                <option value="Europe/Stockholm">Stockholm (CET)</option>
                <option value="Europe/Athens">Athens (EET)</option>
                <option value="Europe/Moscow">Moscow (MSK)</option>
              </optgroup>
              <optgroup label="üåè Asia/Pacific">
                <option value="Asia/Dubai">Dubai (GST)</option>
                <option value="Asia/Kolkata">India (IST)</option>
                <option value="Asia/Bangkok">Bangkok (ICT)</option>
                <option value="Asia/Singapore">Singapore (SGT)</option>
                <option value="Asia/Hong_Kong">Hong Kong (HKT)</option>
                <option value="Asia/Shanghai">Shanghai (CST)</option>
                <option value="Asia/Tokyo">Tokyo (JST)</option>
                <option value="Asia/Seoul">Seoul (KST)</option>
                <option value="Australia/Perth">Perth (AWST)</option>
                <option value="Australia/Sydney">Sydney (AEST)</option>
                <option value="Pacific/Auckland">New Zealand (NZST)</option>
              </optgroup>
              <optgroup label="üåé Americas">
                <option value="America/Mexico_City">Mexico City (CST)</option>
                <option value="America/Bogota">Bogota (COT)</option>
                <option value="America/Lima">Lima (PET)</option>
                <option value="America/Santiago">Santiago (CLT)</option>
                <option value="America/Sao_Paulo">S√£o Paulo (BRT)</option>
                <option value="America/Buenos_Aires">Buenos Aires (ART)</option>
              </optgroup>
              <optgroup label="üåç Africa/Middle East">
                <option value="Africa/Cairo">Cairo (EET)</option>
                <option value="Africa/Lagos">Lagos (WAT)</option>
                <option value="Africa/Johannesburg">Johannesburg (SAST)</option>
                <option value="Asia/Jerusalem">Jerusalem (IST)</option>
              </optgroup>
            </select>
          </div>
          <div class="form-group">
            <label>Expiration time (when schedules with dates in name auto-delete)</label>
            <input type="time" id="settingExpirationTime" value="23:59">
            <small style="color: var(--text-muted);">Schedules with YYYY-MM-DD in name will delete after this time on that date</small>
          </div>
          <br>
          <button class="btn btn-primary" id="saveSettingsBtn">Save Settings</button>
          <hr style="margin: 24px 0; border: none; border-top: 1px solid var(--border);">
          <button class="btn btn-outline" id="testNotificationBtn">Test Notification</button>
          <button class="btn btn-outline" id="repairSchedulesBtn" style="margin-left: 8px;">üîß Repair Stuck Schedules</button>
          <p style="font-size: 12px; color: var(--text-muted); margin-top: 8px;">If schedules aren't opening, click Repair to fix any stuck recurring schedules.</p>
        </div>
      </div>
    </main>
  </div>
  
  <div class="bulk-actions" id="bulkActions">
    <span><strong id="selectedCount">0</strong> selected</span>
    <button class="btn btn-secondary btn-sm" id="bulkResolveBtn">üîç Resolve URLs</button>
    <button class="btn btn-secondary btn-sm" id="bulkOpenAllBtn">Open All Selected</button>
    <button class="btn btn-primary btn-sm" id="bulkRescheduleBtn">üìÖ Reschedule ‚≠ê</button>
    <button class="btn btn-outline btn-sm" id="bulkShiftTimeBtn">‚è±Ô∏è Shift Time ‚≠ê</button>
    <button class="btn btn-outline btn-sm" id="bulkDuplicateBtn">Duplicate</button>
    <button class="btn btn-danger btn-sm" id="bulkDeleteBtn">Delete</button>
    <button class="btn btn-outline btn-sm" id="bulkClearBtn">Clear</button>
  </div>
  
  <div class="modal-overlay" id="editModal">
    <div class="modal">
      <div class="modal-header">
        <h3>Edit Schedule</h3>
        <button class="modal-close" id="editModalClose">&times;</button>
      </div>
      <div class="modal-body">
        <input type="hidden" id="editId">
        <div class="form-group">
          <label>URL</label>
          <input type="url" id="editUrl">
        </div>
        <div class="form-group">
          <label>Name</label>
          <input type="text" id="editName">
        </div>
        <div class="form-group">
          <label>Category</label>
          <select id="editCategory"></select>
        </div>
        <input type="hidden" id="editFolder" value="default">
        <div class="form-group">
          <label>Color</label>
          <div class="color-options" id="editColorOptions">
            <div class="color-option" data-color="" style="background: linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 75%, #ccc 75%), linear-gradient(45deg, #ccc 25%, #fff 25%, #fff 75%, #ccc 75%); background-size: 8px 8px;"></div>
            <div class="color-option" data-color="#ef4444" style="background: #ef4444;"></div>
            <div class="color-option" data-color="#f97316" style="background: #f97316;"></div>
            <div class="color-option" data-color="#eab308" style="background: #eab308;"></div>
            <div class="color-option" data-color="#22c55e" style="background: #22c55e;"></div>
            <div class="color-option" data-color="#06b6d4" style="background: #06b6d4;"></div>
            <div class="color-option" data-color="#3b82f6" style="background: #3b82f6;"></div>
            <div class="color-option" data-color="#8b5cf6" style="background: #8b5cf6;"></div>
            <div class="color-option" data-color="#ec4899" style="background: #ec4899;"></div>
          </div>
          <input type="hidden" id="editColor" value="">
        </div>
        <div class="form-group">
          <label>Open at</label>
          <input type="datetime-local" id="editDatetime" step="1">
        </div>
        <div class="form-group">
          <label><input type="checkbox" id="editRecurring"> Recurring</label>
        </div>
        <div class="form-group">
          <label>Repeat Type</label>
          <select id="editRepeatType">
            <option value="none">No Repeat (One-time)</option>
            <option value="daily">Daily</option>
            <option value="weekdays">Weekdays (Mon-Fri)</option>
            <option value="weekends">Weekends (Sat-Sun)</option>
            <option value="weekly">Weekly</option>
            <option value="biweekly">Every 2 Weeks</option>
            <option value="every3weeks">Every 3 Weeks</option>
            <option value="monthly">Monthly</option>
            <option value="bimonthly">Every 2 Months</option>
            <option value="quarterly">Quarterly (Every 3 Months)</option>
            <option value="every6months">Every 6 Months</option>
            <option value="yearly">Yearly</option>
            <option value="leapyear">Leap Year (Every 4 Years)</option>
            <option value="minutes">Every X Minutes</option>
            <option value="hourly">Every X Hours</option>
            <option value="custom-days">Custom Days Interval</option>
          </select>
        </div>
        <div class="form-group" id="editMinuteGroup" style="display: none;">
          <label>Repeat every <input type="number" id="editMinuteInterval" min="1" max="59" value="10" style="width: 60px; display: inline;"> minutes</label>
        </div>
        <div class="form-group" id="editHourlyGroup" style="display: none;">
          <label>Repeat every <input type="number" id="editHourlyInterval" min="1" max="23" value="6" style="width: 60px; display: inline;"> hours</label>
        </div>
        <div class="form-group" id="editCustomDaysGroup" style="display: none;">
          <label>Repeat every <input type="number" id="editCustomDays" min="2" max="365" value="3" style="width: 60px; display: inline;"> days</label>
        </div>
        <div class="form-group">
          <label>Auto re-lock (minutes) - use 0 for Never</label>
          <input type="number" id="editLockMinutes" min="0" value="5">
        </div>
        <div class="form-group">
          <label><input type="checkbox" id="editAutoClose"> Auto-close tab after opening</label>
        </div>
        <div class="form-group" id="editAutoCloseGroup" style="display: none;">
          <label>Close tab after <input type="number" id="editAutoCloseMinutes" min="1" max="60" value="5" style="width: 60px; display: inline;"> minutes</label>
        </div>
        <div class="form-group">
          <label><input type="checkbox" id="editPlaySound"> üîä Play sound when tab opens</label>
        </div>
        
        <!-- Notes (Premium) -->
        <div class="form-group premium-feature">
          <label>üìù Notes <span class="premium-badge" style="font-size: 10px; padding: 2px 6px; margin-left: 4px;">PRO</span></label>
          <textarea id="editNotes" rows="4" placeholder="Add notes about this schedule... (reminders, instructions, etc.)" style="width: 100%; padding: 10px; border: 1px solid var(--border); border-radius: 8px; resize: vertical; min-height: 80px; max-height: 300px;"></textarea>
          <small style="color: var(--text-muted);">Use this to add reminders, instructions, or any other notes for this schedule.</small>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-outline" id="editCancelBtn">Cancel</button>
        <button class="btn btn-primary" id="editSaveBtn">Save Changes</button>
      </div>
    </div>
  </div>
  
  <div class="modal-overlay" id="shortcutsModal">
    <div class="modal">
      <div class="modal-header">
        <h3>Keyboard Shortcuts</h3>
        <button class="modal-close" id="shortcutsModalClose">&times;</button>
      </div>
      <div class="modal-body">
        <div class="shortcuts-grid">
          <div class="shortcut-item"><span>Schedule page</span><div class="shortcut-keys"><span class="key">Alt</span><span class="key">L</span></div></div>
          <div class="shortcut-item"><span>Unschedule page</span><div class="shortcut-keys"><span class="key">Alt</span><span class="key">U</span></div></div>
          <div class="shortcut-item"><span>Open TabTimer</span><div class="shortcut-keys"><span class="key">Alt</span><span class="key">O</span></div></div>
          <div class="shortcut-item"><span>Search</span><div class="shortcut-keys"><span class="key">Ctrl</span><span class="key">F</span></div></div>
          <div class="shortcut-item"><span>Select all</span><div class="shortcut-keys"><span class="key">Ctrl</span><span class="key">A</span></div></div>
          <div class="shortcut-item"><span>Select range</span><div class="shortcut-keys"><span class="key">Shift</span><span class="key">Click</span></div></div>
          <div class="shortcut-item"><span>Add to selection</span><div class="shortcut-keys"><span class="key">Ctrl</span><span class="key">Click</span></div></div>
          <div class="shortcut-item"><span>Delete selected</span><div class="shortcut-keys"><span class="key">Del</span></div></div>
          <div class="shortcut-item"><span>Duplicate</span><div class="shortcut-keys"><span class="key">Ctrl</span><span class="key">D</span></div></div>
          <div class="shortcut-item"><span>New schedule</span><div class="shortcut-keys"><span class="key">Ctrl</span><span class="key">N</span></div></div>
          <div class="shortcut-item"><span>Toggle theme</span><div class="shortcut-keys"><span class="key">Ctrl</span><span class="key">T</span></div></div>
          <div class="shortcut-item"><span>Pause/Resume all</span><div class="shortcut-keys"><span class="key">Ctrl</span><span class="key">P</span></div></div>
          <div class="shortcut-item"><span>Deselect / Close modal</span><div class="shortcut-keys"><span class="key">Esc</span></div></div>
          <div class="shortcut-item"><span>Show shortcuts</span><div class="shortcut-keys"><span class="key">?</span></div></div>
        </div>
      </div>
    </div>
  </div>
  
  <div class="modal-overlay" id="shiftTimeModal">
    <div class="modal" style="max-width: 400px;">
      <div class="modal-header">
        <h3>Shift Time</h3>
        <button class="modal-close" id="shiftTimeClose">&times;</button>
      </div>
      <div class="modal-body">
        <p style="margin-bottom: 16px;">Shift the scheduled time for selected items:</p>
        <div class="form-group">
          <label>Minutes to shift (negative = earlier)</label>
          <input type="number" id="shiftMinutes" value="60">
        </div>
        <div class="btn-group" style="margin-bottom: 16px;">
          <button class="btn btn-outline btn-sm shift-preset-btn" data-minutes="-60">-1 hr</button>
          <button class="btn btn-outline btn-sm shift-preset-btn" data-minutes="-30">-30 min</button>
          <button class="btn btn-outline btn-sm shift-preset-btn" data-minutes="30">+30 min</button>
          <button class="btn btn-outline btn-sm shift-preset-btn" data-minutes="60">+1 hr</button>
          <button class="btn btn-outline btn-sm shift-preset-btn" data-minutes="1440">+1 day</button>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-outline" id="shiftTimeCancelBtn">Cancel</button>
        <button class="btn btn-primary" id="shiftTimeConfirmBtn">Shift Time</button>
      </div>
    </div>
  </div>
  
  <!-- Bulk Reschedule Modal -->
  <div class="modal-overlay" id="bulkRescheduleModal">
    <div class="modal" style="max-width: 550px;">
      <div class="modal-header">
        <h3>üìÖ Bulk Reschedule</h3>
        <button class="modal-close" id="bulkRescheduleClose">&times;</button>
      </div>
      <div class="modal-body">
        <p style="margin-bottom: 16px;">Reschedule <strong id="rescheduleCount">0</strong> selected schedules with staggered times:</p>
        
        <div class="form-group">
          <label>Start time for first schedule</label>
          <input type="datetime-local" id="rescheduleStartTime" step="1">
        </div>
        
        <div class="form-group">
          <label>Interval between each schedule</label>
          <select id="rescheduleInterval">
            <option value="15">15 seconds</option>
            <option value="30">30 seconds</option>
            <option value="45">45 seconds</option>
            <option value="60" selected>1 minute</option>
            <option value="90">1 minute 30 seconds</option>
            <option value="120">2 minutes</option>
            <option value="180">3 minutes</option>
            <option value="300">5 minutes</option>
            <option value="600">10 minutes</option>
          </select>
        </div>
        
        <div id="reschedulePreview" style="background: var(--bg); border-radius: 8px; padding: 12px; margin-top: 16px; max-height: 200px; overflow-y: auto;">
          <div style="font-weight: 600; margin-bottom: 8px;">Preview:</div>
          <div id="reschedulePreviewList" style="font-size: 13px;"></div>
        </div>
        
        <div id="rescheduleConflicts" style="background: #fef3c7; border: 1px solid #f59e0b; border-radius: 8px; padding: 12px; margin-top: 12px; display: none;">
          <div style="font-weight: 600; color: #92400e; margin-bottom: 8px;">‚ö†Ô∏è Conflicts Detected:</div>
          <div id="rescheduleConflictList" style="font-size: 13px; color: #92400e;"></div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-outline" id="bulkRescheduleCancelBtn">Cancel</button>
        <button class="btn btn-primary" id="bulkRescheduleConfirmBtn">Reschedule All</button>
      </div>
    </div>
  </div>

  <div class="modal-overlay" id="licenseModal">
    <div class="modal" style="max-width: 520px;">
      <div class="modal-header">
        <h3>‚ú® TabTimer Premium</h3>
        <button class="modal-close" id="licenseModalClose">&times;</button>
      </div>
      <div class="modal-body">
        <div id="licenseStatusBox" style="margin-bottom: 20px; padding: 16px; background: var(--bg); border-radius: 10px; text-align: center;">Loading...</div>
        
        <!-- Free user: Show trial option -->
        <div id="freeUserSection" style="display: none;">
          <div style="background: linear-gradient(135deg, #8b5cf6 0%, #6366f1 100%); padding: 20px; border-radius: 12px; color: white; text-align: center; margin-bottom: 16px;">
            <h3 style="margin-bottom: 8px;">üéâ Try Premium FREE for 7 Days!</h3>
            <p style="font-size: 14px; opacity: 0.9; margin-bottom: 16px;">Unlock all premium features with no commitment.</p>
            <button class="btn" id="startTrialBtn" style="background: white; color: #6366f1; font-weight: 600; padding: 12px 32px;">Start Free Trial</button>
          </div>
          <p style="font-size: 13px; color: var(--text-muted); text-align: center;">No credit card required. Trial ends automatically.</p>
        </div>
        
        <!-- Trial/Expired user: Show buy option -->
        <div id="upgradeSection" style="display: none;">
          <div style="background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); padding: 16px; border-radius: 10px; margin-bottom: 16px;">
            <h4 style="color: #92400e; margin-bottom: 10px;">‚≠ê Premium Features Include:</h4>
            <ul style="color: #92400e; font-size: 13px; padding-left: 20px; margin: 0;">
              <li>üì• Bulk Import - Import multiple URLs at once</li>
              <li>üìÖ Bulk Reschedule - Reschedule with staggered times</li>
              <li>üè∑Ô∏è Categories - Organize with custom categories</li>
              <li>üìã Duplicate - Copy schedules with time options</li>
              <li>‚è∞ Grace Period - Configure missed schedule handling</li>
              <li>‚ôæÔ∏è Lifetime Access - Pay once, use forever</li>
            </ul>
          </div>
          <a href="https://www.paypal.com/ncp/payment/QGYD6ZRDWXRES" target="_blank" class="btn btn-primary" style="width: 100%; text-decoration: none; display: block; text-align: center; font-size: 16px; padding: 14px;">üí≥ Buy Premium - $10 (Lifetime)</a>
          <p style="font-size: 12px; color: var(--text-muted); text-align: center; margin-top: 8px;">One-time payment. No subscription. License key emailed within 24-48 hours Monday-Friday.</p>
        </div>
        
        <!-- License key entry -->
        <div id="licenseKeySection" style="margin-top: 20px; padding-top: 20px; border-top: 1px solid var(--border);">
          <h4 style="margin-bottom: 12px;">üîë Already have a license key?</h4>
          <div class="form-group" style="margin-bottom: 12px;">
            <input type="text" id="licenseKeyInput" placeholder="TTXX-XXXX-XXXX-XXXX" style="text-transform: uppercase; font-family: monospace;">
          </div>
          <button class="btn btn-secondary" id="activateLicenseBtn" style="width: 100%;">Activate License</button>
        </div>
        
        <!-- Premium user: Show status -->
        <div id="premiumUserSection" style="display: none; text-align: center;">
          <div style="font-size: 48px; margin-bottom: 12px;">üéâ</div>
          <h3 style="color: #22c55e; margin-bottom: 8px;">Premium Activated!</h3>
          <p style="color: var(--text-muted);">Thank you for supporting TabTimer. Enjoy all premium features!</p>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Backups Modal -->
  <div class="modal-overlay" id="backupsModal">
    <div class="modal" style="max-width: 600px;">
      <div class="modal-header">
        <h3>üìÅ Saved Backups</h3>
        <button class="modal-close" id="backupsModalClose">&times;</button>
      </div>
      <div class="modal-body">
        <div id="backupsList" style="max-height: 400px; overflow-y: auto;">
          <p style="color: var(--text-muted);">Loading backups...</p>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-danger btn-sm" id="clearAllBackupsBtn">üóëÔ∏è Clear All Backups</button>
        <button class="btn btn-outline" id="backupsCloseBtn">Close</button>
      </div>
    </div>
  </div>
  
  <!-- Duplicate Time Conflict Modal -->
  <div class="modal-overlay" id="duplicateTimeModal">
    <div class="modal" style="max-width: 500px;">
      <div class="modal-header">
        <h3>üìã Duplicate Schedule</h3>
        <button class="modal-close" id="duplicateTimeModalClose">&times;</button>
      </div>
      <div class="modal-body">
        <p style="margin-bottom: 12px;"><strong>Creating duplicate of:</strong></p>
        <div id="duplicateSourceName" style="background: var(--bg); padding: 12px; border-radius: 8px; margin-bottom: 16px; font-weight: 600;"></div>
        
        <p style="margin-bottom: 12px;">‚ö†Ô∏è <strong>This time slot is already taken:</strong></p>
        <div id="duplicateCurrentTime" style="background: #fef3c7; border: 1px solid #f59e0b; padding: 12px; border-radius: 8px; margin-bottom: 16px; color: #92400e;"></div>
        
        <p style="margin-bottom: 12px;">Choose when to schedule the duplicate:</p>
        
        <div id="duplicateNextTimeBox" style="background: #f0fdf4; border: 1px solid #86efac; padding: 12px; border-radius: 8px; margin-bottom: 12px;">
          <strong>üïê Next available time:</strong>
          <span id="duplicateNextTime" style="color: #16a34a; font-weight: 600;"></span>
        </div>
        
        <div class="form-group" style="margin-bottom: 0;">
          <label>Or choose a custom time:</label>
          <input type="datetime-local" id="duplicateTimeCustom" style="width: 100%;">
        </div>
      </div>
      <div class="modal-footer" style="flex-wrap: wrap; gap: 8px;">
        <button class="btn btn-outline" id="duplicateTimeCancelBtn">Cancel</button>
        <button class="btn btn-secondary" id="duplicateTimeSameBtn">Use Same Time</button>
        <button class="btn btn-primary" id="duplicateTimeNextBtn">Use Next Available</button>
        <button class="btn btn-primary" id="duplicateTimeCustomBtn">Use Custom Time</button>
      </div>
    </div>
  </div>
  
  <!-- Duplicate URL Modal -->
  <div class="modal-overlay" id="duplicateModal">
    <div class="modal" style="max-width: 550px;">
      <div class="modal-header">
        <h3>‚ö†Ô∏è Duplicate URL Found</h3>
        <button class="modal-close" id="duplicateModalClose">&times;</button>
      </div>
      <div class="modal-body">
        <p style="margin-bottom: 12px;"><strong>This URL is already scheduled:</strong></p>
        <div id="duplicateUrlDisplay" style="background: var(--bg); padding: 12px; border-radius: 8px; margin-bottom: 16px; word-break: break-all; font-family: monospace; font-size: 13px;"></div>
        
        <p style="margin-bottom: 8px;"><strong>Existing schedule:</strong></p>
        <div id="existingScheduleInfo" style="background: var(--bg); padding: 12px; border-radius: 8px; margin-bottom: 16px; font-size: 14px;"></div>
        
        <p style="margin-bottom: 12px;">What would you like to do?</p>
        
        <div id="duplicateNextTimeOption" style="background: #f0fdf4; border: 1px solid #86efac; padding: 12px; border-radius: 8px; margin-bottom: 12px;">
          <strong>üïê Next available time:</strong>
          <span id="nextAvailableTime" style="color: #16a34a; font-weight: 600;"></span>
        </div>
        
        <div class="form-group" style="margin-bottom: 0;">
          <label>Or choose a custom time:</label>
          <input type="datetime-local" id="duplicateCustomTime" style="width: 100%;">
        </div>
      </div>
      <div class="modal-footer" style="flex-wrap: wrap; gap: 8px;">
        <button class="btn btn-outline" id="duplicateSkipBtn">Skip This URL</button>
        <button class="btn btn-outline" id="duplicateSkipAllBtn">Skip All Duplicates</button>
        <button class="btn btn-secondary" id="duplicateAddNextBtn">Add at Next Time</button>
        <button class="btn btn-primary" id="duplicateAddCustomBtn">Add at Custom Time</button>
      </div>
    </div>
  </div>
  
  <!-- Notes View Modal -->
  <div class="modal-overlay" id="notesModal">
    <div class="modal" style="max-width: 500px;">
      <div class="modal-header">
        <h3>üìù Notes</h3>
        <button class="modal-close" id="notesModalClose">&times;</button>
      </div>
      <div class="modal-body">
        <div style="margin-bottom: 12px;">
          <strong id="notesModalName" style="font-size: 16px;"></strong>
          <div id="notesModalUrl" style="font-size: 12px; color: var(--text-muted); margin-top: 4px; word-break: break-all;"></div>
        </div>
        <div id="notesModalContent" style="background: var(--bg); padding: 16px; border-radius: 8px; white-space: pre-wrap; line-height: 1.6; max-height: 400px; overflow-y: auto;"></div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-outline" id="notesModalCloseBtn">Close</button>
        <button class="btn btn-primary" id="notesModalEditBtn">‚úèÔ∏è Edit</button>
      </div>
    </div>
  </div>
  
  <div class="toast" id="toast"><span id="toastMessage">Success!</span></div>
  
  <script src="xlsx-parser.js"></script>
  <script src="options.js"></script>
</body>
</html>
